---
title: "AlexDoc"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(glmnet)
library(stringr)
library(bnstruct)
```


```{r}
heart <- read.csv(file = 'heart.csv')
heart %>% 
  count(Cholesterol)
heart %>% 
  count(RestingBP)
heart %>% 
  count(Age)
heart %>% 
  count(MaxHR)
heart %>% 
  count(Oldpeak)
heart %>% 
  count(ST_Slope)
heart %>% 
  count(HeartDisease)
heart <- heart %>% 
  mutate(Sex = as.factor(Sex)) %>% 
  mutate(ChestPainType= as.factor(ChestPainType)) %>% 
  mutate(RestingECG= as.factor(RestingECG)) %>%
  mutate(ExerciseAngina = as.factor(ExerciseAngina)) %>%
  mutate(ST_Slope = as.factor(ST_Slope)) %>%
  mutate(HeartDisease = as.factor(HeartDisease)) 
#imputed <- knn.impute(as.matrix(heart),k = 10)
  
heart <- heart %>% 
  filter(Cholesterol != 0) %>% 
  filter(RestingBP!=0)
```

```{r}
x <- model.matrix(HeartDisease~., heart)[,-1]
y <- heart$HeartDisease
#Finding optimal lambda shrinkage value to reduce error through cross validation
set.seed(123)


cv.lasso <- cv.glmnet(x, y, alpha = 1, family = "binomial")
#Creation of lasso model and outputting regression coefficients
lasso_model <- glmnet(x, y, alpha = 1, family = "binomial",
lambda = cv.lasso$lambda.min)
coef(lasso_model)
```

```{r}

x <- model.matrix(HeartDisease~.^2, heart)[,-1]
y <- heart$HeartDisease
#Finding optimal lambda shrinkage value to reduce error through cross validation
set.seed(123)


cv.lasso <- cv.glmnet(x, y, alpha = 1, family = "binomial")
#Creation of lasso model and outputting regression coefficients
lasso_model <- glmnet(x, y, alpha = 1, family = "binomial",
lambda = cv.lasso$lambda.min)
coef(lasso_model)

```

