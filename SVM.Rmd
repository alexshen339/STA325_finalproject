---
title: "svm"
output: pdf_document
---

```{r}
library(tidyverse)
library(stringr)
library(e1071)
```

```{r}
heart <- read.csv(file = 'heart.csv')
heart %>% 
  count(Cholesterol)
heart %>% 
  count(RestingBP)
heart %>% 
  count(Age)
heart %>% 
  count(MaxHR)
heart %>% 
  count(Oldpeak)
heart %>% 
  count(ST_Slope)
heart %>% 
  count(HeartDisease)
heart <- heart %>% 
  filter(Cholesterol != 0) %>% 
  filter(RestingBP!=0)
```

```{r}
set.seed(1)
x <- model.matrix(HeartDisease~., heart)[,-1]
y <- heart$HeartDisease
#x[y==1,] = x[y==1,] + 1
#plot(x, col = (3-y))

svmfit <- svm(y ~ ., data = heart, kernel = "linear", cost = 10, scale = FALSE)
summary(svmfit)
```



